/*!
 *     ____  __  ______  __________ _    _____________       ____________
 *    / __ \/ / / / __ \/_  __/ __ \ |  / /  _/ ____/ |     / / ____/ __ \
 *   / /_/ / /_/ / / / / / / / / / / | / // // __/  | | /| / / __/ / /_/ /
 *  / ____/ __  / /_/ / / / / /_/ /| |/ // // /___  | |/ |/ / /___/ _, _/
 * /_/   /_/ /_/\____/ /_/  \____/ |___/___/_____/  |__/|__/_____/_/ |_|
 *
 * photoviewer - v3.6.2
 * A JS plugin to view images just like in Windows
 * https://nzbin.github.io/photoviewer/
 *
 * Copyright (c) 2018 nzbin
 * Released under MIT License
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).photoviewer=e()}(this,function(){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var w=function(t,e){return new w.fn.init(t,e)},y=window.document,o=[],s=o.concat,a=o.filter,b=o.slice,r={},e={},i={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},h=/^\s*<(\w+|!)[^>]*>/,l=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,c=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,u=/^(?:body|html)$/i,d=["val","css","html","text","data","width","height","offset"],t=y.createElement("table"),f=y.createElement("tr"),p={tr:y.createElement("tbody"),tbody:t,thead:t,tfoot:t,td:f,th:f,"*":y.createElement("div")},g=/^[\w-]*$/,m={},v=m.toString,x=y.createElement("div"),z=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},$=y.documentElement.contains?function(t,e){return t!==e&&t.contains(e)}:function(t,e){for(;e=e&&e.parentNode;)if(e===t)return!0;return!1};function M(t){return null==t?String(t):m[v.call(t)]||"object"}function T(t){return"function"==M(t)}function C(t){return null!=t&&t==t.window}function L(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function H(t){return"object"==M(t)}function k(t){return H(t)&&!C(t)&&Object.getPrototypeOf(t)==Object.prototype}function D(t){var e=!!t&&"length"in t&&t.length,i=M(t);return"function"!=i&&!C(t)&&("array"==i||0===e||"number"==typeof e&&0<e&&e-1 in t)}function V(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function E(t,e){return"number"!=typeof e||i[V(t)]?e:e+"px"}function I(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})}function P(t){return t in e?e[t]:e[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function _(t){return t instanceof w}function A(t,e,i,o){return T(e)?e.call(t,i,o):e}function R(t,e,i){null==i?t.removeAttribute(e):t.setAttribute(e,i)}function S(t,e){var i=t.className||"",o=i&&void 0!==i.baseVal;if(void 0===e)return o?i.baseVal:i;o?i.baseVal=e:t.className=e}function O(t,e){var i={width:["padding-left","padding-right","border-left-width","border-right-width"],height:["padding-top","padding-bottom","border-top-width","border-bottom-width"]};return"border-box"!==t.css("box-sizing")||0<window.navigator.userAgent.indexOf("MSIE ")||navigator.userAgent.match(/Trident.*rv:11\./)?parseFloat(t.css(e)):parseFloat(t.css(e))-parseFloat(t.css(i[e][0]))-parseFloat(t.css(i[e][1]))-parseFloat(t.css(i[e][2]))-parseFloat(t.css(i[e][3]))}function F(e,i){var t=e.replace(/./,function(t){return t[0].toUpperCase()}),o=this[0];return void 0===i?C(o)?o.document.documentElement["client"+t]:L(o)?o.documentElement["scroll"+t]:O(this,e):this.each(function(t){(o=w(this)).css(e,A(this,i,t,o[e]()))})}w.fn=w.prototype={constuctor:w,length:0,forEach:o.forEach,reduce:o.reduce,push:o.push,sort:o.sort,splice:o.splice,indexOf:o.indexOf,init:function(t,e){var i,o;if(!t)return this;if("string"==typeof t)if("<"==(t=t.trim())[0]&&h.test(t))i=w.fragment(t,RegExp.$1,e),t=null;else{if(void 0!==e)return w(e).find(t);i=w.qsa(y,t)}else{if(T(t))return w(y).ready(t);if(_(t))return t;if(z(t))o=t,i=a.call(o,function(t){return null!=t});else if(H(t))i=[t],t=null;else{if(void 0!==e)return w(e).find(t);i=w.qsa(y,t)}}return w.makeArray(i,t,this)},concat:function(){for(var t,e=[],i=0;i<arguments.length;i++)e[i]=_(t=arguments[i])?t.toArray():t;return s.apply(_(this)?this.toArray():this,e)},pluck:function(e){return w.map(this,function(t){return t[e]})},toArray:function(){return this.get()},get:function(t){return void 0===t?b.call(this):this[0<=t?t:t+this.length]},size:function(){return this.length},each:function(i){return o.every.call(this,function(t,e){return!1!==i.call(t,e,t)}),this},map:function(i){return w(w.map(this,function(t,e){return i.call(t,e,t)}))},slice:function(){return w(b.apply(this,arguments))},first:function(){var t=this[0];return t&&!H(t)?t:w(t)},last:function(){var t=this[this.length-1];return t&&!H(t)?t:w(t)},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)}},w.extend=w.fn.extend=function(){var t,e,i,o,n,s=arguments[0]||{},a=1,r=arguments.length,h=!1;for("boolean"==typeof s&&(h=s,s=arguments[a]||{},a++),"object"==typeof s||T(s)||(s={}),a===r&&(s=this,a--);a<r;a++)if(null!=(t=arguments[a]))for(e in t)n=s[e],s!==(i=t[e])&&(h&&i&&(k(i)||(o=z(i)))?(n=o?(o=!1,n&&z(n)?n:[]):n&&k(n)?n:{},s[e]=w.extend(h,n,i)):void 0!==i&&(s[e]=i));return s},w.extend({makeArray:function(t,e,i){for(var o=t?t.length:0,n=0;n<o;n++)i[n]=t[n];return i.length=o,i.selector=e||"",i},qsa:function(t,e){var i,o="#"==e[0],n=!o&&"."==e[0],s=o||n?e.slice(1):e,a=g.test(s);return t.getElementById&&a&&o?(i=t.getElementById(s))?[i]:[]:1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType?[]:b.call(a&&!o&&t.getElementsByClassName?n?t.getElementsByClassName(s):t.getElementsByTagName(e):t.querySelectorAll(e))},fragment:function(t,e,i){var o,n,s;return(o=l.test(t)?w(y.createElement(RegExp.$1)):o)||(t.replace&&(t=t.replace(c,"<$1></$2>")),void 0===e&&(e=h.test(t)&&RegExp.$1),(s=p[e=!(e in p)?"*":e]).innerHTML=""+t,o=w.each(b.call(s.childNodes),function(){s.removeChild(this)})),k(i)&&(n=w(o),w.each(i,function(t,e){-1<d.indexOf(t)?n[t](e):n.attr(t,e)})),o},matches:function(t,e){if(!e||!t||1!==t.nodeType)return!1;var i=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(i)return i.call(t,e);var o=t.parentNode,i=!o;return i&&(o=x).appendChild(t),e=~w.qsa(o,e).indexOf(t),i&&x.removeChild(t),e},each:function(t,e){var i,o;if(D(t)){for(i=0;i<t.length;i++)if(!1===e.call(t[i],i,t[i]))return t}else for(o in t)if(!1===e.call(t[o],o,t[o]))return t;return t},map:function(t,e){var i,o,n,s,a=[];if(D(t))for(o=0;o<t.length;o++)null!=(i=e(t[o],o))&&a.push(i);else for(n in t)null!=(i=e(t[n],n))&&a.push(i);return 0<(s=a).length?w.fn.concat.apply([],s):s}}),w.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){m["[object "+e+"]"]=e.toLowerCase()}),w.fn.init.prototype=w.fn;var B=function(t,e){e(t);for(var i=0,o=t.childNodes.length;i<o;i++)B(t.childNodes[i],e)};var j=1;function N(t){return t._zid||(t._zid=j++)}function Y(t){return"string"==typeof t}function X(){return!0}function W(){return!1}var q={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function Z(o,n){if(n||!o.isDefaultPrevented){n=n||o,w.each(q,function(t,e){var i=n[t];o[t]=function(){return this[e]=X,i&&i.apply(n,arguments)},o[e]=W});try{o.timeStamp||(o.timeStamp=Date.now())}catch(t){console.warn(t)}(void 0!==n.defaultPrevented?n.defaultPrevented:"returnValue"in n?!1===n.returnValue:n.getPreventDefault&&n.getPreventDefault())&&(o.isDefaultPrevented=X)}return o}var K={},U="onfocusin"in window,G={focus:"focusin",blur:"focusout"},J={mouseenter:"mouseover",mouseleave:"mouseout"},Q=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/;function tt(t){t=(""+t).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function et(t,e,i,o){var n,s;return(e=tt(e)).ns&&(s=e.ns,n=new RegExp("(?:^| )"+s.replace(" "," .* ?")+"(?: |$)")),(K[N(t)]||[]).filter(function(t){return t&&(!e.e||t.e==e.e)&&(!e.ns||n.test(t.ns))&&(!i||N(t.fn)===N(i))&&(!o||t.sel==o)})}function it(t,e){return t.del&&!U&&t.e in G||!!e}function ot(t){return J[t]||U&&G[t]||t}function nt(e,t,i,o,n){var s=N(e);(t||"").split(/\s/).forEach(function(t){et(e,t,i,o).forEach(function(t){delete K[s][t.i],"removeEventListener"in e&&e.removeEventListener(ot(t.e),t.proxy,it(t,n))})})}var st,at="",rt=y.createElement("div"),ht=rt.style.transitionProperty;function lt(t){return st?st+t:t.toLowerCase()}void 0===rt.style.transform&&w.each({Webkit:"webkit",Moz:"",O:"o"},function(t,e){if(void 0!==rt.style[t+"TransitionProperty"])return at="-"+t.toLowerCase()+"-",st=e,!1}),rt=null,w.fx={off:void 0===st&&void 0===ht,speeds:{_default:400,fast:200,slow:600},cssPrefix:at,transitionEnd:lt("TransitionEnd"),animationEnd:lt("AnimationEnd")};var ct,ut,dt,ft,pt,gt,mt,vt,wt,yt=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,bt={};ct=at+"transform",bt[ut=at+"transition-property"]=bt[dt=at+"transition-duration"]=bt[pt=at+"transition-delay"]=bt[ft=at+"transition-timing-function"]=bt[gt=at+"animation-name"]=bt[mt=at+"animation-duration"]=bt[wt=at+"animation-delay"]=bt[vt=at+"animation-timing-function"]="";function xt(){return this.each(function(){var t,e,i;"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=(t=this.nodeName,r[t]||(e=y.createElement(t),y.body.appendChild(e),i=getComputedStyle(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),r[t]=i="none"==i?"block":i),r[t]))})}var zt=function(){return this.css("display","none")};function $t(t,e,i,o,n){"function"!=typeof e||n||(n=e,e=void 0);i={opacity:i};return o&&(i.scale=o,t.css(w.fx.cssPrefix+"transform-origin","0 0")),t.animate(i,e,null,n)}var Mt=w,Tt={find:function(t){var i=this,e=t?"object"==typeof t?w(t).filter(function(){var e=this;return o.some.call(i,function(t){return $(t,e)})}):1==this.length?w(w.qsa(this[0],t)):this.map(function(){return w.qsa(this,t)}):w();return e},closest:function(i,o){var n=[],s="object"==typeof i&&w(i);return this.each(function(t,e){for(;e&&!(s?0<=s.indexOf(e):w.matches(e,i));)e=e!==o&&!L(e)&&e.parentNode;e&&n.indexOf(e)<0&&n.push(e)}),w(n)},css:function(t,e){if(arguments.length<2){var i=this[0];if("string"==typeof t)return i?i.style[I(t)]||getComputedStyle(i,"").getPropertyValue(t):void 0;if(z(t)){if(!i)return;var o={},n=getComputedStyle(i,"");return w.each(t,function(t,e){o[e]=i.style[I(e)]||n.getPropertyValue(e)}),o}}var s="";if("string"==M(t))e||0===e?s=V(t)+":"+E(t,e):this.each(function(){this.style.removeProperty(V(t))});else for(var a in t)t[a]||0===t[a]?s+=V(a)+":"+E(a,t[a])+";":this.each(function(){this.style.removeProperty(V(a))});return this.each(function(){this.style.cssText+=";"+s})},addClass:function(i){var o=[];return i?this.each(function(t){var e;"className"in this&&(o=[],e=S(this),A(this,i,t,e).split(/\s+/g).forEach(function(t){w(this).hasClass(t)||o.push(t)},this),o.length&&S(this,e+(e?" ":"")+o.join(" ")))}):this},hasClass:function(t){return!!t&&o.some.call(this,function(t){return this.test(S(t))},P(t))},removeClass:function(e){var i=[];return this.each(function(t){if("className"in this){if(void 0===e)return S(this,"");i=S(this),A(this,e,t,i).split(/\s+/g).forEach(function(t){i=i.replace(P(t)," ")}),S(this,i.trim())}})},attr:function(i,o){var t;return"string"!=typeof i||1 in arguments?this.each(function(t){if(1===this.nodeType)if(H(i))for(var e in i)R(this,e,i[e]);else R(this,i,A(this,o,t,this.getAttribute(i)))}):0 in this&&1==this[0].nodeType&&null!=(t=this[0].getAttribute(i))?t:void 0},removeAttr:function(t){return this.each(function(){1===this.nodeType&&t.split(" ").forEach(function(t){R(this,t)},this)})},append:function(){return t=this,e=arguments,o=function(t){this.insertBefore(t,null)},n=!0,a=w.map(e,function(t){var e=[];return"array"==(i=M(t))?(t.forEach(function(t){return void 0!==t.nodeType?e.push(t):_(t)?e=e.concat(t.get()):void(e=e.concat(w.fragment(t)))}),e):"object"==i||null==t?t:w.fragment(t)}),r=1<t.length,a.length<1?t:t.each(function(t,e){s=n?e:e.parentNode;var i=$(y.documentElement,s);a.forEach(function(t){if(r)t=t.cloneNode(!0);else if(!s)return w(t).remove();o.call(e,t),i&&B(t,function(t){var e;null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src||(e=t.ownerDocument?t.ownerDocument.defaultView:window).eval.call(e,t.innerHTML)})})});var t,e,o,n,i,s,a,r},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},empty:function(){return this.each(function(){this.innerHTML=""})},html:function(i){return 0 in arguments?this.each(function(t){var e=this.innerHTML;w(this).empty().append(A(this,i,t,e))}):0 in this?this[0].innerHTML:null},width:function(t){return F.call(this,"width",t)},height:function(t){return F.call(this,"height",t)},scrollTop:function(t){if(this.length){var e="scrollTop"in this[0];return void 0===t?e?this[0].scrollTop:(C(this[0])?this[0]:this[0].defaultView).pageYOffset:this.each(e?function(){this.scrollTop=t}:function(){this.scrollTo(this.scrollX,t)})}},scrollLeft:function(t){if(this.length){var e="scrollLeft"in this[0];return void 0===t?e?this[0].scrollLeft:(C(this[0])?this[0]:this[0].defaultView).pageXOffset:this.each(e?function(){this.scrollLeft=t}:function(){this.scrollTo(t,this.scrollY)})}},offset:function(o){if(o)return this.each(function(t){var e=w(this),i=A(this,o,t,e.offset()),t=e.offsetParent().offset(),t={top:i.top-t.top,left:i.left-t.left};"static"==e.css("position")&&(t.position="relative"),e.css(t)});if(!this.length)return null;if(y.documentElement!==this[0]&&!$(y.documentElement,this[0]))return{top:0,left:0};var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:Math.round(t.width),height:Math.round(t.height)}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||y.body;t&&!u.test(t.nodeName)&&"static"==w(t).css("position");)t=t.offsetParent;return t})},position:function(){if(this.length){var t,e=this[0],i=this.offsetParent(),o=u.test(i[0].nodeName)?{top:0,left:0}:i.offset();return"fixed"===w(e).css("position")?t=e.getBoundingClientRect():(t=this.offset(),o.top+=parseFloat(w(i[0]).css("border-top-width"))||0,o.left+=parseFloat(w(i[0]).css("border-left-width"))||0),{top:t.top-o.top-parseFloat(w(e).css("margin-top"))||0,left:t.left-o.left-parseFloat(w(e).css("margin-left"))||0}}},on:function(u,d,f,p,g){var m,v,i=this;return u&&!Y(u)?(w.each(u,function(t,e){i.on(t,d,f,e,g)}),i):(Y(d)||T(p)||!1===p||(p=f,f=d,d=void 0),void 0!==p&&!1!==f||(p=f,f=void 0),!1===p&&(p=W),i.each(function(t,i){var o,e,n,s,a,r,h,l,c;g&&(m=function(t){return nt(i,t.type,p),p.apply(this,arguments)}),d&&(v=function(t){var e=w(t.target).closest(d,i).get(0);if(e&&e!==i)return t=w.extend(function(t){var e,i={originalEvent:t};for(e in t)Q.test(e)||void 0===t[e]||(i[e]=t[e]);return Z(i,t)}(t),{currentTarget:e,liveFired:i}),(m||p).apply(e,[t].concat(b.call(arguments,1)))}),e=u,n=p,s=f,a=d,r=v||m,l=N(o=i),c=K[l]||(K[l]=[]),e.split(/\s/).forEach(function(t){if("ready"==t)return w(y).ready(n);var e=tt(t);e.fn=n,e.sel=a,e.e in J&&(n=function(t){t=t.relatedTarget;if(!t||t!==this&&!$(this,t))return e.fn.apply(this,arguments)});var i=(e.del=r)||n;e.proxy=function(t){if(!(t=Z(t)).isImmediatePropagationStopped()){t.data=s;var e=i.apply(o,null==t._args?[t]:[t].concat(t._args));return!1===e&&(t.preventDefault(),t.stopPropagation()),e}},e.i=c.length,c.push(e),"addEventListener"in o&&o.addEventListener(ot(e.e),e.proxy,it(e,h))})}))},off:function(t,i,e){var o=this;return t&&!Y(t)?(w.each(t,function(t,e){o.off(t,i,e)}),o):(Y(i)||T(e)||!1===e||(e=i,i=void 0),!1===e&&(e=W),o.each(function(){nt(this,t,e,i)}))},show:function(t,e){return xt.call(this),void 0===t?t=0:this.css("opacity",0),$t(this,t,1,"1,1",e)},hide:function(t,e){return void 0===t?zt.call(this):(i=e,$t(this,t,0,"0,0",function(){zt.call(w(this)),i&&i.call(this)}));var i},anim:function(t,e,i,o,n){var s,a,r,h={},l="",c=this,u=w.fx.transitionEnd,d=!1;if(void 0===e&&(e=w.fx.speeds._default/1e3),void 0===n&&(n=0),w.fx.off&&(e=0),"string"==typeof t)h[gt]=t,h[mt]=e+"s",h[wt]=n+"s",h[vt]=i||"linear",u=w.fx.animationEnd;else{for(s in a=[],t)yt.test(s)?l+=s+"("+t[s]+") ":(h[s]=t[s],a.push(s.replace(/([A-Z])/g,"-$1").toLowerCase()));l&&(h[ct]=l,a.push(ct)),0<e&&"object"==typeof t&&(h[ut]=a.join(", "),h[dt]=e+"s",h[pt]=n+"s",h[ft]=i||"linear")}return r=function(t){if(void 0!==t){if(t.target!==t.currentTarget)return;w(t.target).off(u,r)}else w(this).off(u,r);d=!0,w(this).css(bt),o&&o.call(this)},0<e&&(this.on(u,r),setTimeout(function(){d||r.call(c)},1e3*(e+n)+25)),this.size()&&this.get(0).clientLeft,this.css(h),e<=0&&setTimeout(function(){c.each(function(){r.call(this)})},0),this},animate:function(t,e,i,o,n){return T(e)&&(o=e,e=i=void 0),T(i)&&(o=i,i=void 0),k(e)&&(i=e.easing,o=e.complete,n=e.delay,e=e.duration),e=e&&("number"==typeof e?e:w.fx.speeds[e]||w.fx.speeds._default)/1e3,n=n&&parseFloat(n)/1e3,this.anim(t,e,i,o,n)},fadeTo:function(t,e,i){return $t(this,t,e,null,i)},fadeIn:function(t,e){var i=this.css("opacity");return 0<i?this.css("opacity",0):i=1,xt.call(this).fadeTo(t,i,e)}};Mt.extend({isPlainObject:k,isArray:z,noop:function(){}}),Mt.fn.extend(Tt);var Ct={draggable:!0,resizable:!0,movable:!0,keyboard:!0,title:!0,modalWidth:320,modalHeight:320,fixedModalSize:!1,initMaximized:!1,gapThreshold:.02,ratioThreshold:.1,minRatio:.05,maxRatio:16,headerToolbar:["maximize","close"],footerToolbar:["zoomIn","zoomOut","prev","fullscreen","next","actualSize","rotateRight"],icons:{minimize:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M20,14H4V10H20"></path>\n      </svg>',maximize:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M4,4H20V20H4V4M6,8V18H18V8H6Z"></path>\n      </svg>',close:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M13.46,12L19,17.54V19H17.54L12,13.46L6.46,19H5V17.54L10.54,12\n        L5,6.46V5H6.46L12,10.54L17.54,5H19V6.46L13.46,12Z"></path>\n      </svg>',zoomIn:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M15.5,14L20.5,19L19,20.5L14,15.5V14.71L13.73,14.43\n        C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3A6.5,6.5 0 0,1 16,9.5\n        C16,11.11 15.41,12.59 14.43,13.73L14.71,14H15.5M9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5\n        C7,5 5,7 5,9.5C5,12 7,14 9.5,14M12,10H10V12H9V10H7V9H9V7H10V9H12V10Z"></path>\n      </svg>',zoomOut:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M15.5,14H14.71L14.43,13.73C15.41,12.59 16,11.11 16,9.5\n        A6.5,6.5 0 0,0 9.5,3A6.5,6.5 0 0,0 3,9.5A6.5,6.5 0 0,0 9.5,16\n        C11.11,16 12.59,15.41 13.73,14.43L14,14.71V15.5L19,20.5L20.5,19L15.5,14M9.5,14\n        C7,14 5,12 5,9.5C5,7 7,5 9.5,5C12,5 14,7 14,9.5C14,12 12,14 9.5,14M7,9H12V10H7V9Z"></path>\n      </svg>',prev:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M6,18V6H8V18H6M9.5,12L18,6V18L9.5,12Z"></path>\n      </svg>',next:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M16,18H18V6H16M6,18L14.5,12L6,6V18Z"></path>\n      </svg>',fullscreen:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M8.5,12.5L11,15.5L14.5,11L19,17H5M23,18V6A2,2 0 0,0 21,4H3\n        A2,2 0 0,0 1,6V18A2,2 0 0,0 3,20H21A2,2 0 0,0 23,18Z"></path>\n      </svg>',actualSize:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M9.5,13.09L10.91,14.5L6.41,19H10V21H3V14H5V17.59L9.5,13.09\n        M10.91,9.5L9.5,10.91L5,6.41V10H3V3H10V5H6.41L10.91,9.5M14.5,13.09L19,17.59V14H21V21H14V19\n        H17.59L13.09,14.5L14.5,13.09M13.09,9.5L17.59,5H14V3H21V10H19V6.41L14.5,10.91\n        L13.09,9.5Z"></path>\n      </svg>',rotateLeft:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M13,4.07V1L8.45,5.55L13,10V6.09C15.84,6.57 18,9.03 18,12\n        C18,14.97 15.84,17.43 13,17.91V19.93C16.95,19.44 20,16.08 20,12C20,7.92 16.95,4.56 13,4.07\n        M7.1,18.32C8.26,19.22 9.61,19.76 11,19.93V17.9C10.13,17.75 9.29,17.41 8.54,16.87L7.1,18.32\n        M6.09,13H4.07C4.24,14.39 4.79,15.73 5.69,16.89L7.1,15.47C6.58,14.72 6.23,13.88 6.09,13\n        M7.11,8.53L5.7,7.11C4.8,8.27 4.24,9.61 4.07,11H6.09C6.23,10.13 6.58,9.28 7.11,8.53Z"></path>\n      </svg>',rotateRight:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M16.89,15.5L18.31,16.89C19.21,15.73 19.76,14.39 19.93,13H17.91\n        C17.77,13.87 17.43,14.72 16.89,15.5M13,17.9V19.92C14.39,19.75 15.74,19.21 16.9,18.31\n        L15.46,16.87C14.71,17.41 13.87,17.76 13,17.9M19.93,11C19.76,9.61 19.21,8.27 18.31,7.11\n        L16.89,8.53C17.43,9.28 17.77,10.13 17.91,11M15.55,5.55L11,1V4.07C7.06,4.56 4,7.92 4,12\n        C4,16.08 7.05,19.44 11,19.93V17.91C8.16,17.43 6,14.97 6,12C6,9.03 8.16,6.57 11,6.09V10\n        L15.55,5.55Z"></path>\n      </svg>'},i18n:{minimize:"minimize",maximize:"maximize",close:"close",zoomIn:"zoom-in (+)",zoomOut:"zoom-out (-)",prev:"prev (←)",next:"next (→)",fullscreen:"fullscreen",actualSize:"actual-size (Ctrl+Alt+0)",rotateLeft:"rotate-left (Ctrl+,)",rotateRight:"rotate-right (Ctrl+.)"},multiInstances:!0,initAnimation:!0,animationDuration:400,fixedModalPos:!1,zIndex:1090,dragHandle:null,callbacks:{beforeOpen:Mt.noop,opened:Mt.noop,beforeClose:Mt.noop,closed:Mt.noop,beforeChange:Mt.noop,changed:Mt.noop},index:0,progressiveLoading:!0,appendTo:"body",customButtons:{},positionFixed:!0,initModalPos:null},Lt=window.document;function Ht(t,e,i,o){var n=o?t.h:t.w,t=o?t.w:t.h;(t>e.h||n>e.w)&&i.addClass("is-grab"),t<=e.h&&n<=e.w&&i.removeClass("is-grab")}function kt(){return"ontouchstart"in window||window.DocumentTouch&&Lt instanceof window.DocumentTouch}function Dt(t){return/^(?:body|html)$/i.test(t.nodeName)}function Vt(i,t){return t.reduce(function(t,e){return t+parseFloat(i.css(e))},0)}function Et(t){return"border-box"===t.css("box-sizing")}var It=Mt(window),Pt=Mt(Lt),_t="click",At="keydown",Rt="wheel mousewheel DOMMouseScroll",St=kt()?"touchstart":"mousedown",Ot=kt()?"touchmove":"mousemove",Ft=kt()?"touchend":"mouseup",Bt="photoviewer",jt="."+Bt,Nt="."+Bt,Yt={isMoving:!1,isResizing:!1,zIndex:0},t={draggable:function(i,t,e){var o=this,n=!1,s=0,a=0,r=0,h=0,l=function(t){var e;(t=t||window.event).preventDefault(),!n||Yt.isMoving||Yt.isResizing||o.isMaximized||(e="touchmove"===t.type?t.targetTouches[0].pageX:t.clientX,t="touchmove"===t.type?t.targetTouches[0].pageY:t.clientY,e=e-s,t=t-a,i.css({left:e+r,top:t+h}))},c=function t(){Pt.off(Ot+Nt,l).off(Ft+Nt,t),n=!1,i[0].focus()};Mt(t).on(St+Nt,function(t){if(t=t||window.event,i[0].blur(),Mt(t.target).closest(e).length)return!0;o.options.multiInstances&&i.css("z-index",++Yt.zIndex),n=!0,s="touchstart"===t.type?t.targetTouches[0].pageX:t.clientX,a="touchstart"===t.type?t.targetTouches[0].pageY:t.clientY,r=parseFloat(i.css("left")),h=parseFloat(i.css("top")),Pt.on(Ot+Nt,l).on(Ft+Nt,c)})}},Xt="html, body, .".concat(Bt,"-modal, .").concat(Bt,"-stage, .").concat(Bt,"-button, .").concat(Bt,"-resizable-handle"),f={movable:function(s,a){function r(){Pt.off(Ot+Nt,v).off(Ft+Nt,r),l=!1,Yt.isMoving=!1,Mt(Xt).removeClass("is-grabbing")}var h=this,l=!1,c=0,u=0,d=0,f=0,p=0,g=0,m=0,v=function(t){var e,i,o;(t=t||window.event).preventDefault(),l&&(i="touchmove"===t.type?t.targetTouches[0].pageX:t.clientX,o="touchmove"===t.type?t.targetTouches[0].pageY:t.clientY,t=(e=i-c)+d,o=(i=o-u)+f,0<g?m<i+f?o=m:i+f<-g+m&&(o=-g+m):o=f,0<p?-m<e+d?t=-m:e+d<-p-m&&(t=-p-m):t=d,a.css({left:t,top:o}),Mt.extend(h.imageData,{left:t,top:o}))};s.on(St+Nt,function(t){(t=t||window.event).preventDefault();var e=a.width(),i=a.height(),o=s.width(),n=s.height();c="touchstart"===t.type?t.targetTouches[0].pageX:t.clientX,u="touchstart"===t.type?t.targetTouches[0].pageY:t.clientY,m=h.isRotated?(e-i)/2:0,p=h.isRotated?i-o:e-o,g=h.isRotated?e-n:i-n,l=0<p||0<g,Yt.isMoving=0<p||0<g,d=a.position().left-m,f=a.position().top+m,s.hasClass("is-grab")&&Mt(Xt).addClass("is-grabbing"),Pt.on(Ot+Nt,v).on(Ft+Nt,r)})}},Wt="html, body, .".concat(Bt,"-modal, .").concat(Bt,"-stage, .").concat(Bt,"-button"),ht={resizable:function(o,n,l,c,u){var s=this,t=Mt('<div class="'.concat(Bt,"-resizable-handle ").concat(Bt,'-resizable-handle-e"></div>')),e=Mt('<div class="'.concat(Bt,"-resizable-handle ").concat(Bt,'-resizable-handle-w"></div>')),i=Mt('<div class="'.concat(Bt,"-resizable-handle ").concat(Bt,'-resizable-handle-s"></div>')),a=Mt('<div class="'.concat(Bt,"-resizable-handle ").concat(Bt,'-resizable-handle-n"></div>')),r=Mt('<div class="'.concat(Bt,"-resizable-handle ").concat(Bt,'-resizable-handle-se"></div>')),h=Mt('<div class="'.concat(Bt,"-resizable-handle ").concat(Bt,'-resizable-handle-sw"></div>')),d=Mt('<div class="'.concat(Bt,"-resizable-handle ").concat(Bt,'-resizable-handle-ne"></div>')),f=Mt('<div class="'.concat(Bt,"-resizable-handle ").concat(Bt,'-resizable-handle-nw"></div>')),p={e:t,s:i,se:r,n:a,w:e,nw:f,ne:d,sw:h};o.append(t,e,i,a,r,h,d,f);var g=!1,m=0,v=0,w={w:0,h:0,l:0,t:0},y={w:0,h:0,l:0,t:0},b={w:0,h:0,l:0,t:0},x=0,z=0,$=0,M="",T=function(t,e,i){var o=-e+w.w>c?e+w.l:w.l+w.w-c,n=-i+w.h>u?i+w.t:w.t+w.h-u;return{e:{width:Math.max(e+w.w,c)},s:{height:Math.max(i+w.h,u)},se:{width:Math.max(e+w.w,c),height:Math.max(i+w.h,u)},w:{width:Math.max(-e+w.w,c),left:o},n:{height:Math.max(-i+w.h,u),top:n},nw:{width:Math.max(-e+w.w,c),height:Math.max(-i+w.h,u),top:n,left:o},ne:{width:Math.max(e+w.w,c),height:Math.max(-i+w.h,u),top:n},sw:{width:Math.max(-e+w.w,c),height:Math.max(i+w.h,u),left:o}}[t]},C=function(t,e,i){var o=e+w.w>c?y.w-z+e-x:c-(w.w-y.w)-z-x,n=i+w.h>u?y.h-$+i+x:u-(w.h-y.h)-$+x,s=-e+w.w>c?y.w-z-e-x:c-(w.w-y.w)-z-x,a=-i+w.h>u?y.h-$-i+x:u-(w.h-y.h)-$+x,r=(0<o||l.position().left<0?l.position().left:0)-x,h=(0<n||l.position().top<0?l.position().top:0)+x,e=(0<s||l.position().left<0?l.position().left:0)-x,i=(0<a||l.position().top<0?l.position().top:0)+x;return{e:{left:-x<=o?(o-x)/2:o<r?r:o},s:{top:x<=n?(n+x)/2:n<h?h:n},se:{top:x<=n?(n+x)/2:n<h?h:n,left:-x<=o?(o-x)/2:o<r?r:o},w:{left:-x<=s?(s-x)/2:s<e?e:s},n:{top:x<=a?(a+x)/2:a<i?i:a},nw:{top:x<=a?(a+x)/2:a<i?i:a,left:-x<=s?(s-x)/2:s<e?e:s},ne:{top:x<=a?(a+x)/2:a<i?i:a,left:-x<=o?(o-x)/2:o<r?r:o},sw:{top:x<=n?(n+x)/2:n<h?h:n,left:-x<=s?(s-x)/2:s<e?e:s}}[t]},L=function(t){var e,i;(t=t||window.event).preventDefault(),g&&!s.isMaximized&&(i="touchmove"===t.type?t.targetTouches[0].pageX:t.clientX,e="touchmove"===t.type?t.targetTouches[0].pageY:t.clientY,e=T(M,t=i-m,i=e-v),o.css(e),i=C(M,t,i),l.css(i),s.isDoResize=!0)},H=function t(){Pt.off(Ot+Nt,L).off(Ft+Nt,t),Yt.isResizing&&Ht({w:z,h:$},{w:n.width(),h:n.height()},n),g=!1,Yt.isResizing=!1,Mt(Wt).css("cursor","");var e=s.getImageScale(n.width(),n.height());Mt.extend(s.imageData,{initWidth:s.img.width*e,initHeight:s.img.height*e,initLeft:(n.width()-s.img.width*e)/2,initTop:(n.height()-s.img.height*e)/2})};Mt.each(p,function(i,t){t.on(St+Nt,function(t){var e;e=i,(t=(t=t)||window.event).preventDefault(),g=!0,Yt.isResizing=!0,m="touchstart"===t.type?t.targetTouches[0].pageX:t.clientX,v="touchstart"===t.type?t.targetTouches[0].pageY:t.clientY,w={w:o.width(),h:o.height(),l:o.position().left,t:o.position().top},y={w:n.width(),h:n.height(),l:n.position().left,t:n.position().top},b={w:l.width(),h:l.height(),l:l.position().left,t:l.position().top},x=s.isRotated?(b.w-b.h)/2:0,z=s.isRotated?b.h:b.w,$=s.isRotated?b.w:b.h,M=e,Mt(Wt).css("cursor",e+"-resize"),Pt.on(Ot+Nt,L).on(Ft+Nt,H)})})}},Tt=function(){function o(t,e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this.options=Mt.extend(!0,{},Ct,e),e&&Mt.isArray(e.footerToolbar)&&(this.options.footerToolbar=e.footerToolbar),e&&Mt.isArray(e.headerToolbar)&&(this.options.headerToolbar=e.headerToolbar),this.$el=Mt(i),this.isOpened=!1,this.isMaximized=!1,this.isRotated=!1,this.rotateAngle=0,this.isDoResize=!1,this.imageData={},this.modalData={width:null,height:null,left:null,top:null},this._lastTimestamp=0,this.init(t,this.options)}var t,e,i;return t=o,(e=[{key:"init",value:function(t,e){this.groupData=t,this.groupIndex=e.index,Yt.zIndex=(0===Yt.zIndex?e:Yt).zIndex;t=t[this.groupIndex].src;this.open(),this.loadImage(t),e.draggable&&this.draggable(this.$photoviewer,this.dragHandle,jt+"-button"),e.movable&&this.movable(this.$stage,this.$image),e.resizable&&this.resizable(this.$photoviewer,this.$stage,this.$image,e.modalWidth,e.modalHeight)}},{key:"_createBtns",value:function(t){var o=this,n=["minimize","maximize","close","zoomIn","zoomOut","prev","next","fullscreen","actualSize","rotateLeft","rotateRight"],s="";return Mt.each(t,function(t,e){var i="".concat(Bt,"-button ").concat(Bt,"-button-").concat(e);0<=n.indexOf(e)?s+='<button class="'.concat(i,'" title="').concat(o.options.i18n[e],'">\n          ').concat(o.options.icons[e],"\n          </button>"):o.options.customButtons[e]&&(s+='<button class="'.concat(i,'" title="').concat(o.options.customButtons[e].title||"",'">\n          ').concat(o.options.customButtons[e].text,"\n          </button>"))}),s}},{key:"_createTitle",value:function(){return this.options.title?'<div class="'.concat(Bt,'-title"></div>'):""}},{key:"_createTemplate",value:function(){return'<div class="'.concat(Bt,'-modal" tabindex="0">\n        <div class="').concat(Bt,'-inner">\n          <div class="').concat(Bt,'-header">\n            <div class="').concat(Bt,"-toolbar ").concat(Bt,'-toolbar-header">\n            ').concat(this._createBtns(this.options.headerToolbar),"\n            </div>\n            ").concat(this._createTitle(),'\n          </div>\n          <div class="').concat(Bt,'-stage">\n            <img class="').concat(Bt,'-image" src="" alt="" />\n          </div>\n          <div class="').concat(Bt,'-footer">\n            <div class="').concat(Bt,"-toolbar ").concat(Bt,'-toolbar-footer">\n            ').concat(this._createBtns(this.options.footerToolbar),"\n            </div>\n          </div>\n        </div>\n      </div>")}},{key:"build",value:function(){var t=this._createTemplate(),t=Mt(t);this.$photoviewer=t,this.$stage=t.find(jt+"-stage"),this.$title=t.find(jt+"-title"),this.$image=t.find(jt+"-image"),this.$close=t.find(jt+"-button-close"),this.$maximize=t.find(jt+"-button-maximize"),this.$minimize=t.find(jt+"-button-minimize"),this.$zoomIn=t.find(jt+"-button-zoomIn"),this.$zoomOut=t.find(jt+"-button-zoomOut"),this.$actualSize=t.find(jt+"-button-actualSize"),this.$fullscreen=t.find(jt+"-button-fullscreen"),this.$rotateLeft=t.find(jt+"-button-rotateLeft"),this.$rotateRight=t.find(jt+"-button-rotateRight"),this.$prev=t.find(jt+"-button-prev"),this.$next=t.find(jt+"-button-next"),this.$stage.addClass("stage-ready"),this.$image.addClass("image-ready"),this.$photoviewer.css("z-index",Yt.zIndex),this.options.positionFixed&&this.$photoviewer.css({position:"fixed"}),this.options.dragHandle&&this.options.dragHandle!==jt+"-modal"?this.dragHandle=this.$photoviewer.find(this.options.dragHandle):this.dragHandle=this.$photoviewer,Mt(this.options.appendTo).eq(0).append(this.$photoviewer),this._stageEdgeValue={horizontal:Vt(this.$stage,["left","right","border-left-width","border-right-width"]),vertical:Vt(this.$stage,["top","bottom","border-top-width","border-bottom-width"])},this._modalEdgeValue={horizontal:Vt(this.$photoviewer,["padding-left","padding-right","border-left-width","border-right-width"]),vertical:Vt(this.$photoviewer,["padding-top","padding-bottom","border-top-width","border-bottom-width"])},this._addEvents(),this._addCustomButtonEvents()}},{key:"open",value:function(){this._triggerHook("beforeOpen",this),this.options.multiInstances||Mt(jt+"-modal").eq(0).remove(),this.build(),this.setInitModalPos(),this._triggerHook("opened",this)}},{key:"close",value:function(){this._triggerHook("beforeClose",this),this.$photoviewer.remove(),this.isOpened=!1,this.isMaximized=!1,this.isRotated=!1,this.rotateAngle=0,Mt(jt+"-modal").length||(this.options.multiInstances&&(Yt.zIndex=this.options.zIndex),It.off("resize"+Nt)),this._triggerHook("closed",this)}},{key:"_getOffsetParentData",value:function(){var t=Mt(this.options.appendTo)[0];return{width:this.options.positionFixed||Dt(t)?It.width():t.clientWidth,height:this.options.positionFixed||Dt(t)?It.height():t.clientHeight,scrollLeft:this.options.positionFixed?0:Dt(t)?Pt.scrollLeft():t.scrollLeft,scrollTop:this.options.positionFixed?0:Dt(t)?Pt.scrollTop():t.scrollTop}}},{key:"setModalToCenter",value:function(){var t,e=0,i=0,o=0,n=0,s=0,a=0;Et(this.$photoviewer)||(s+=this._modalEdgeValue.horizontal,a+=this._modalEdgeValue.vertical),Mt.isPlainObject(this.options.initModalPos)?(e=this.options.initModalPos.left,i=this.options.initModalPos.top,o=this.options.initModalPos.right,n=this.options.initModalPos.bottom):(e=((t=this._getOffsetParentData()).width-this.options.modalWidth-s)/2+t.scrollLeft,i=(t.height-this.options.modalHeight-a)/2+t.scrollTop);n={width:this.modalData.width||this.options.modalWidth,height:this.modalData.height||this.options.modalHeight,left:this.modalData.left||e,top:this.modalData.top||i,right:this.modalData.right||o,bottom:this.modalData.bottom||n};this.$photoviewer.css(n)}},{key:"setInitModalPos",value:function(){this.options.initMaximized?(this.maximize(),this.isOpened=!0):this.setModalToCenter(),this.$photoviewer[0].focus()}},{key:"setModalSize",value:function(t){var e=this,i=this._getOffsetParentData(),o=t.width+this._stageEdgeValue.horizontal,n=t.height+this._stageEdgeValue.vertical,s=0,a=0;Et(this.$photoviewer)?(o+=this._modalEdgeValue.horizontal,n+=this._modalEdgeValue.vertical):(s+=this._modalEdgeValue.horizontal,a+=this._modalEdgeValue.vertical);var r=(0<this.options.gapThreshold?this.options.gapThreshold:0)+1,h=Math.min(i.width/((o+s)*r),i.height/((n+a)*r),1),l=Math.max(o*h,this.options.modalWidth),c=Math.max(n*h,this.options.modalHeight),l=this.options.fixedModalSize?this.options.modalWidth:Math.round(l),c=this.options.fixedModalSize?this.options.modalHeight:Math.round(c),i=0,r=0,o=0,n=0;Mt.isPlainObject(this.options.initModalPos)?(i=this.options.initModalPos.left,r=this.options.initModalPos.top,o=this.options.initModalPos.right,n=this.options.initModalPos.bottom):(i=((h=this._getOffsetParentData()).width-l-s)/2+h.scrollLeft,r=(h.height-c-a)/2+h.scrollTop);n={width:l,height:c,left:i,top:r,right:o,bottom:n};this.options.initAnimation?this.$photoviewer.animate(n,this.options.animationDuration,"ease-in-out",function(){e.setImageSize(t)}):(this.$photoviewer.css(n),this.setImageSize(t)),this.isOpened=!0}},{key:"getImageScale",value:function(t,e){return this.isRotated?Math.min(t/this.img.height,e/this.img.width,1):Math.min(t/this.img.width,e/this.img.height,1)}},{key:"setImageSize",value:function(t){var e={w:this.$stage.width(),h:this.$stage.height()},i=this.getImageScale(e.w,e.h);this.$image.css({width:Math.round(t.width*i),height:Math.round(t.height*i),left:(e.w-Math.round(t.width*i))/2,top:(e.h-Math.round(t.height*i))/2}),Mt.extend(this.imageData,{initWidth:t.width*i,initHeight:t.height*i,initLeft:(e.w-t.width*i)/2,initTop:(e.h-t.height*i)/2,width:t.width*i,height:t.height*i,left:(e.w-t.width*i)/2,top:(e.h-t.height*i)/2}),Ht({w:this.$image.width(),h:this.$image.height()},{w:this.$stage.width(),h:this.$stage.height()},this.$stage,this.isRotated),this.imageLoaded||(this.$photoviewer.find(jt+"-loader").remove(),this.$stage.removeClass("stage-ready"),this.$image.removeClass("image-ready"),this.options.initAnimation&&!this.options.progressiveLoading&&this.$image.fadeIn(),this.imageLoaded=!0)}},{key:"loadImage",value:function(t,e,i){var o,n,s,a,r=this;this.$image.removeAttr("style").attr("src",""),this.isRotated=!1,this.rotateAngle=0,this.imageLoaded=!1,this.$photoviewer.append('<div class="'.concat(Bt,'-loader"></div>')),this.$stage.addClass("stage-ready"),this.$image.addClass("image-ready"),this.options.initAnimation&&!this.options.progressiveLoading&&this.$image.hide(),this.$image.attr("src",t),o=t,n=function(t){r.img=t,r.imageData={originalWidth:t.width,originalHeight:t.height},r.isMaximized||r.isOpened&&r.options.fixedModalPos?r.setImageSize(t):r.setModalSize(t),e&&e.call()},s=function(){r.$photoviewer.find(jt+"-loader").remove(),i&&i.call()},(a=new Image).onload=function(){n(a)},a.onerror=function(){s(a)},a.src=o,this.options.title&&this.setImageTitle(t)}},{key:"setImageTitle",value:function(t){t=this.groupData[this.groupIndex].title||t.replace(/^.*?\/*([^/?]*)\.[a-z]+(\?.+|$)/gi,"$1");this.$title.html(t)}},{key:"jump",value:function(t){this._triggerHook("beforeChange",[this,this.groupIndex]);var e=Date.now();e-this._lastTimestamp>=this.options.animationDuration&&(this.groupIndex=this.groupIndex+t,this.jumpTo(this.groupIndex),this._lastTimestamp=e)}},{key:"jumpTo",value:function(t){var e=this;0<=(t%=this.groupData.length)?t%=this.groupData.length:t<0&&(t=(this.groupData.length+t)%this.groupData.length),this.groupIndex=t,this.loadImage(this.groupData[t].src,function(){e._triggerHook("changed",[e,t])},function(){e._triggerHook("changed",[e,t])})}},{key:"wheel",value:function(t){t.preventDefault();var e=1;t.deltaY?e=0<t.deltaY?1:-1:t.wheelDelta?e=-t.wheelDelta/120:t.detail&&(e=0<t.detail?1:-1);var i=-e*this.options.ratioThreshold,e={x:t.clientX-this.$stage.offset().left+Pt.scrollLeft(),y:t.clientY-this.$stage.offset().top+Pt.scrollTop()};this.zoom(i,e,t)}},{key:"zoom",value:function(t,e,i){t=t<0?1/(1-t):1+t,(t=this.$image.width()/this.imageData.originalWidth*t)>this.options.maxRatio||t<this.options.minRatio||this.zoomTo(t,e,i)}},{key:"zoomTo",value:function(t,e,i){var o=this.$image,n=this.$stage,s=this.imageData.width,a=this.imageData.height,r=this.imageData.left,h=this.imageData.top,l={w:n.width(),h:n.height(),x:n.offset().left,y:n.offset().top},c=this.imageData.originalWidth*t,u=this.imageData.originalHeight*t,n=e.x-(e.x-r)/s*c,t=e.y-(e.y-h)/a*u,r=this.isRotated?(c-u)/2:0,s=this.isRotated?u:c,e=this.isRotated?c:u,h=l.w-c,a=l.h-u,t=e<=l.h?(l.h-u)/2:r<t?r:a-r<t?t:a-r,n=s<=l.w?(l.w-c)/2:-r<n?-r:h+r<n?n:h+r;Math.abs(this.imageData.initWidth-c)<.05*this.imageData.initWidth?this.setImageSize(this.img):(o.css({width:Math.round(c),height:Math.round(u),left:Math.round(n),top:Math.round(t)}),Ht({w:Math.round(s),h:Math.round(e)},{w:l.w,h:l.h},this.$stage)),Mt.extend(this.imageData,{width:c,height:u,left:n,top:t})}},{key:"rotate",value:function(t){this.rotateAngle=this.rotateAngle+t,this.rotateAngle/90%2==0?this.isRotated=!1:this.isRotated=!0,this.rotateTo(this.rotateAngle)}},{key:"rotateTo",value:function(t){this.$image.css({transform:"rotate("+t+"deg)"}),this.setImageSize({width:this.imageData.originalWidth,height:this.imageData.originalHeight}),this.$stage.removeClass("is-grab")}},{key:"resize",value:function(){this.isOpened&&(this.isMaximized?this.setImageSize({width:this.imageData.originalWidth,height:this.imageData.originalHeight}):this.setModalSize({width:this.imageData.originalWidth,height:this.imageData.originalHeight}))}},{key:"maximize",value:function(){this.$photoviewer.addClass(Bt+"-maximized"),this.$photoviewer.css({width:"auto",height:"auto",top:0,right:0,bottom:0,left:0}),this.isMaximized=!0}},{key:"exitMaximize",value:function(){this.$photoviewer.removeClass(Bt+"-maximized"),this.setModalToCenter(),this.isMaximized=!1}},{key:"_toggleMaximize",value:function(){var t,e;this.isMaximized?this.exitMaximize():(t=parseFloat(this.$photoviewer.width()),e=parseFloat(this.$photoviewer.height()),Et(this.$photoviewer)&&(t+=this._modalEdgeValue.horizontal,e+=this._modalEdgeValue.vertical),this.modalData={width:t,height:e,left:parseFloat(this.$photoviewer.css("left")),top:parseFloat(this.$photoviewer.css("top"))},this.maximize()),this.setImageSize({width:this.imageData.originalWidth,height:this.imageData.originalHeight}),this.$photoviewer[0].focus()}},{key:"fullscreen",value:function(){var t;(t=this.$photoviewer[0]).requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),this.$photoviewer[0].focus()}},{key:"_keydown",value:function(t){if(!this.options.keyboard)return!1;var e=t.keyCode||t.which||t.charCode,i=t.ctrlKey||t.metaKey,o=t.altKey||t.metaKey;switch(e){case 37:this.jump(-1);break;case 39:this.jump(1);break;case 187:this.zoom(3*this.options.ratioThreshold,{x:this.$stage.width()/2,y:this.$stage.height()/2},t);break;case 189:this.zoom(3*-this.options.ratioThreshold,{x:this.$stage.width()/2,y:this.$stage.height()/2},t);break;case 61:this.zoom(3*this.options.ratioThreshold,{x:this.$stage.width()/2,y:this.$stage.height()/2},t);break;case 173:this.zoom(3*-this.options.ratioThreshold,{x:this.$stage.width()/2,y:this.$stage.height()/2},t);break;case 48:i&&o&&this.zoomTo(1,{x:this.$stage.width()/2,y:this.$stage.height()/2},t);break;case 188:i&&this.rotate(-90);break;case 190:i&&this.rotate(90);break;case 81:this.close()}}},{key:"_addEvents",value:function(){var i,o,n,e=this;this.$close.off(_t+Nt).on(_t+Nt,function(t){e.close()}),this.$stage.off(Rt+Nt).on(Rt+Nt,function(t){e.wheel(t)}),this.$zoomIn.off(_t+Nt).on(_t+Nt,function(t){e.zoom(3*e.options.ratioThreshold,{x:e.$stage.width()/2,y:e.$stage.height()/2},t)}),this.$zoomOut.off(_t+Nt).on(_t+Nt,function(t){e.zoom(3*-e.options.ratioThreshold,{x:e.$stage.width()/2,y:e.$stage.height()/2},t)}),this.$actualSize.off(_t+Nt).on(_t+Nt,function(t){e.zoomTo(1,{x:e.$stage.width()/2,y:e.$stage.height()/2},t)}),this.$prev.off(_t+Nt).on(_t+Nt,function(){e.jump(-1)}),this.$fullscreen.off(_t+Nt).on(_t+Nt,function(){e.fullscreen()}),this.$next.off(_t+Nt).on(_t+Nt,function(){e.jump(1)}),this.$rotateLeft.off(_t+Nt).on(_t+Nt,function(){e.rotate(-90)}),this.$rotateRight.off(_t+Nt).on(_t+Nt,function(){e.rotate(90)}),this.$maximize.off(_t+Nt).on(_t+Nt,function(){e._toggleMaximize()}),this.$photoviewer.off(At+Nt).on(At+Nt,function(t){e._keydown(t)}),It.on("resize"+Nt,(i=function(){e.resize()},o=500,n=null,function(){var t=this,e=arguments;clearTimeout(n),n=setTimeout(function(){i.apply(t,e)},o)}))}},{key:"_addCustomButtonEvents",value:function(){var t,i=this;for(t in this.options.customButtons)!function(e){i.$photoviewer.find(jt+"-button-"+e).off(_t+Nt).on(_t+Nt,function(t){i.options.customButtons[e].click.apply(i,[i,t])})}(t)}},{key:"_triggerHook",value:function(t,e){this.options.callbacks[t]&&this.options.callbacks[t].apply(this,Mt.isArray(e)?e:[e])}}])&&n(t.prototype,e),i&&n(t,i),o}();return Mt.extend(Tt.prototype,t,f,ht),window.PhotoViewer=Tt});